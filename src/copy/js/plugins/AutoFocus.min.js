!function(e,n){typeof exports==='object'&&typeof module!=='undefined'?module.exports=n():typeof define==='function'&&define.amd?define(n):(e=e||self, (e.FormValidation=e.FormValidation||{}, e.FormValidation.plugins=e.FormValidation.plugins||{}, e.FormValidation.plugins.AutoFocus=n()))}(this,function(){"use strict";function e(e,n){if(!(e instanceof n)){throw new TypeError("Cannot call a class as a function")}}function n(e,n){for(var t=0;t<n.length;t++){var l=n[t];l.enumerable=l.enumerable||!1;l.configurable=!0;"value" in l&&(l.writable=!0);Object.defineProperty(e,l.key,l)}}function t(e,t,l){t&&n(e.prototype,t);l&&n(e,l);return e}function l(e,n){if(typeof n!=="function"&&n!==null){throw new TypeError("Super expression must either be null or a function")}e.prototype=Object.create(n&&n.prototype,{constructor:{value:e,writable:!0,configurable:!0}});n&&d(e,n)}function o(e){o=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)};return o(e)}function d(e,n){d=Object.setPrototypeOf||function(e,n){e.__proto__=n;return e};return d(e,n)}function i(e){if(e===void 0){throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}return e}function a(e,n){if(n&&(typeof n==="object"||typeof n==="function")){return n}return i(e)}var r=FormValidation.Plugin,s=function(n){l(d,n);function d(n){var t;e(this,d);t=a(this,o(d).call(this,n));t.statuses=new Map;t.opts=Object.assign({},{onStatusChanged:function(){}},n);t.elementValidatingHandler=t.onElementValidating.bind(i(t));t.elementValidatedHandler=t.onElementValidated.bind(i(t));t.elementNotValidatedHandler=t.onElementNotValidated.bind(i(t));t.elementIgnoredHandler=t.onElementIgnored.bind(i(t));t.fieldAddedHandler=t.onFieldAdded.bind(i(t));t.fieldRemovedHandler=t.onFieldRemoved.bind(i(t));return t}t(d,[{key:"install",value:function(){this.core.on('core.element.validating',this.elementValidatingHandler).on('core.element.validated',this.elementValidatedHandler).on('core.element.notvalidated',this.elementNotValidatedHandler).on('core.element.ignored',this.elementIgnoredHandler).on('core.field.added',this.fieldAddedHandler).on('core.field.removed',this.fieldRemovedHandler)}},{key:"uninstall",value:function(){this.statuses.clear();this.core.off('core.element.validating',this.elementValidatingHandler).off('core.element.validated',this.elementValidatedHandler).off('core.element.notvalidated',this.elementNotValidatedHandler).off('core.element.ignored',this.elementIgnoredHandler).off('core.field.added',this.fieldAddedHandler).off('core.field.removed',this.fieldRemovedHandler)}},{key:"areFieldsValid",value:function(){return Array.from(this.statuses.values()).every(function(e){return e==='Valid'})}},{key:"getStatues",value:function(){return this.statuses}},{key:"onFieldAdded",value:function(e){this.statuses.set(e.field,'NotValidated')}},{key:"onFieldRemoved",value:function(e){this.statuses.has(e.field)&&this.statuses["delete"](e.field);this.opts.onStatusChanged(this.areFieldsValid())}},{key:"onElementValidating",value:function(e){this.statuses.set(e.field,'Validating');this.opts.onStatusChanged(!1)}},{key:"onElementValidated",value:function(e){this.statuses.set(e.field,e.valid?'Valid':'Invalid');e.valid?this.opts.onStatusChanged(this.areFieldsValid()):this.opts.onStatusChanged(!1)}},{key:"onElementNotValidated",value:function(e){this.statuses.set(e.field,'NotValidated');this.opts.onStatusChanged(!1)}},{key:"onElementIgnored",value:function(e){this.statuses.set(e.field,'Ignored');this.opts.onStatusChanged(!1)}}]);return d}(r),u=function(n){l(d,n);function d(n){var t;e(this,d);t=a(this,o(d).call(this,n));t.fieldStatusPluginName='___autoFocusFieldStatus';t.opts=Object.assign({},{onPrefocus:function(){}},n);t.invalidFormHandler=t.onFormInvalid.bind(i(t));return t}t(d,[{key:"install",value:function(){this.core.on('core.form.invalid',this.invalidFormHandler).registerPlugin(this.fieldStatusPluginName,new s)}},{key:"uninstall",value:function(){this.core.off('core.form.invalid',this.invalidFormHandler).deregisterPlugin(this.fieldStatusPluginName)}},{key:"onFormInvalid",value:function(){var e=this.core.getPlugin(this.fieldStatusPluginName),n=e.getStatues(),t=Object.keys(this.core.getFields()).filter(function(e){return n.get(e)==='Invalid'});if(t.length>0){var l=t[0],o=this.core.getElements(l);if(o.length>0){var d=o[0],i={firstElement:d};this.core.emit('plugins.autofocus.prefocus',i);this.opts.onPrefocus(i);d.focus()}}}}]);return d}(r);return u})